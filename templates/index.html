<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="background-container"></div>
    <div class="login-container">
        <h1 class="app-title">AI-Powered Assignment Grader</h1>
        <p class="subtitle">Please select your role to log in.</p>
        
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="flash {{ category }}">{{ message }}</div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <div class="role-selection-grid">
            <button class="role-card" onclick="handleRoleSelection('teacher')">
                <i class="fa-solid fa-chalkboard-user"></i>
                <span>Teacher Login</span>
            </button>
            <button class="role-card" onclick="handleRoleSelection('student')">
                <i class="fa-solid fa-user-graduate"></i>
                <span>Student Login</span>
            </button>
            <button class="role-card" onclick="handleRoleSelection('admin')">
                <i class="fa-solid fa-user-shield"></i>
                <span>Admin Login</span>
            </button>
        </div>

        <div class="login-form-wrapper" id="teacher-form">
            <h2>Teacher Login</h2>
            <form action="{{ url_for('login') }}" method="post">
                <label for="teacher_username">Username:</label>
                <input type="text" id="teacher_username" name="username" required>
                <label for="teacher_password">Password:</label>
                <input type="password" id="teacher_password" name="password" required>
                <button type="submit" class="btn">Login as Teacher</button>
            </form>
        </div>

        <div class="login-form-wrapper" id="student-form">
            <h2>Student Login</h2>
            <form action="{{ url_for('login') }}" method="post">
                <label for="student_username">Username:</label>
                <input type="text" id="student_username" name="username" required>
                <label for="student_password">Password:</label>
                <input type="password" id="student_password" name="password" required>
                <button type="submit" class="btn">Login as Student</button>
            </form>
        </div>

        <div class="login-form-wrapper" id="admin-form">
            <h2>Admin Login</h2>
            <form action="{{ url_for('login') }}" method="post">
                <label for="admin_username">Username:</label>
                <input type="text" id="admin_username" name="username" required>
                <label for="admin_password">Password:</label>
                <input type="password" id="admin_password" name="password" required>
                <button type="submit" class="btn">Login as Admin</button>
            </form>
        </div>
    </div>

    <script>
        // Function to handle role selection
        function handleRoleSelection(role) {
            const roleCards = document.querySelectorAll('.role-card');
            const loginForms = document.querySelectorAll('.login-form-wrapper');
            const selectedForm = document.getElementById(`${role}-form`);
            const roleGrid = document.querySelector('.role-selection-grid');

            // Hide the role grid with a fade-out effect
            roleGrid.style.opacity = '0';
            roleGrid.style.transform = 'translateY(-20px)';

            // Wait for the fade-out to complete before showing the form
            setTimeout(() => {
                // Hide all role cards and forms
                roleCards.forEach(card => card.style.display = 'none');
                loginForms.forEach(form => form.style.display = 'none');

                // Show the selected form with a fade-in effect
                selectedForm.style.display = 'block';
                setTimeout(() => {
                    selectedForm.classList.add('visible');
                }, 10); // Small delay to trigger CSS transition
            }, 500); // This timeout should match the CSS transition duration for a smooth effect
        }

        // Add a "breathe" animation to the container on load
        window.addEventListener('load', () => {
            const loginContainer = document.querySelector('.login-container');
            loginContainer.style.animation = 'breathe 3s ease-in-out infinite';
        });
    </script>
</body>
</html>
